# 0. Introduction: 웹 애플리케이션 기초

### 학습 목적

> **_기반 지식을 다지기_**

사용자가 눈에 보이는 부분을 개발하는 부분을 **프론트엔드** ,

사용자 눈에 보이지 않는 부분을 개발하는 부분을 **백엔드** 라 한다.

프론트엔드는 코드 실행 결과를 눈으로 직접 바로바로 확인이 가능하다.  

하지만, **백엔드는 코드의 결과를 눈으로 확인하기 어렵다. 그래서 오류의 원인을 찾는 디버깅이 어렵다**. 

**이 디버깅을 하기 위해서는 기반지식이 필요하다.**  

입문자가 생각하는 개발은 파이썬 코드라고 생각하지만, **실제 개발에 필요한 내용은 기반지식이다.**   

그래서 이번에 기반 지식 아래 내용을 학습해본다.

- 클라이언트 - 서버 구조
- 웹 서버 구조 설계
- 네트워크


<br>

---

# 3. 네트워크 기초

- 여러 개의 계층을 통해 데이터를 송수신한다.  

### OSI 7 layer

- OSI 7 layer의 구성은 다음과 같다.
    | OSI 7 layer |
    | ----| 
    |응용 계층|
    |표현 계층|
    |세션 계층|
    |전송 계층|
    |네트워크 계층|
    |데이터링크 계층|
    |물리계층|


- 그래서 송신할 때는 위에 응용계층부터 물리계층방향으로 진행되어, 수신할 때는 물리계층부터 응용 계층 방향으로 진행되어 데이터를 받는다.  

- 이 **OSI 7 layer** 를 4개의 계층으로 표현한 것을 **TCP/IP 4 layer** 라 한다. 설명은 OSI 7 layer를  기준으로 한다.

    | OSI 7 layer | TCP/IP 4 layer |
    | ---- | ---- |
    |응용 계층| 4. 응용 계층|
    |표현 계층| 4. 응용 계층|
    |세션 계층| 4. 응용 계층|
    |전송 계층| 3. 전송 계층| 
    |네트워크 계층| 2. 인터넷 계층 |
    |데이터링크 계층| 1. 네트워크 접속 계층 | 
    |물리계층| 1. 네트워크 접속 계층 |

- 우리가 우편을 보낼 때, 보낼 물건을 바로 보내는 게 아니라 우편 봉투에 넣고, 주소 태그를 붙이는 것처럼 데이터가 각 계층을 통해 보내질 때, 계층을 한 번 이동할 때마다 계층에 맞는 header(헤더)가 붙여진다.  

- 그리고 데이터 수신 시, 각 계층을 지나갈 때마다 그 계층에 맞는 헤더를 제거해서 응용계층에서 원하는 데이터를 본다.  

![image](http://wiki.hash.kr/images/7/71/OSI_7_%EA%B3%84%EC%B8%B5.jpg)

## 3.1 1계층: 물리계층

- 데이터를 0과 1로 구성된 데이터로 바꾼 후, 이를 전기신호로 바꿔서 보낸다. 그리고, 수신할 때는 이 전기신호를 0과 1로 바꾸고, 이를 다시 데이터로 바꾸는 것이다. 

- 물리계층에서는 물리 장치인 랜선과 랜카드가 필요하다.

<br>

### LAN card

> **_0과 1로 구성된 데이터를 전기 신호로 바꾸는 역할_**

### 1계층 장비: 허브(Hub)

- 이 허브에 여러 개의 포트가 있고, 이 허브를 통해 다른 컴퓨터로 전송한다.

- ❗️ 단점: 이 허브는 받는 상대를 지정할 수 없다. 허브의 포트에 연결된 모든 컴퓨터에게 보내진다.  
    - Why? 1계층에는 지정된 header가 없기 때문이다.  
    - 이러한 단점을 극복할수록 위 계층으로 올라간다고 생각하자.  

<br>

## 3.2 2계층: 데이터링크 계층

> **_Data Link Layer로, 네트워크 장비 사이의 신호를 주고 받는 '규칙을 정하는' 층으로서, 스위치라는 장비를 이용해 스위치에 연결되어 있는 컴퓨터들이 이더넷이라는 규칙하에 프레임을 주고 받는다._**

### 이더넷(ethernet)

> **_랜(LAN, Local Area Network)에 적용되는 규칙으로, 랜선을 꽂을 때 여러 선들이 있는데 이 선들에 대한 규칙을 말한다._**

- 스위치와 같은 장비를 이용해 데이터를 주고 받을 때 사용하는 규칙  

<br>

### 맥 주소(Mac Address)

> **_LAN 카드에는 맥 주소(48비트)가 할당되어 있다._**

- 맥 주소 = 랜카드 제조사 번호(앞 부분) + 랜카드 제조사가 랜카드에 할당한 번호(뒷 부분)

- 맥 주소를 알면 그 PC의 위치를 알 수 있다.  

- 16진수로 표현되어있다.
    - 숫자 1개당 이진수를 보면 4bit로 표현한 것을 알 수 있다. 즉, 48bit는 12개의 문자를 의미한다. 

<br>

### frame(프레임)

- 프레임(frame) = 이더넷 헤더 + 데이터 + FCS
    - FCS = Frame Check Sequence의 약어로, 데이터 전송 중 오류가 발생하는지 확인하는 용도  

- 이더넷 헤더 = 목적지 MAC 주소 + 출발지 MAC 주소 + 유형
    - 목적지 MAC 주소: 6 byte
    - 출발지 MAC 주소: 6 byte
    - 유형: 2 byte ex) IPv4, IPv6, ARP  


<br>

### header(헤더)

> **_전송되는 데이터의 맨 앞에 위치하는 추가적인 정보 데이터를 의미하는데, 데이터의 내용과 성격을 식별 또는 제어하는데 사용_**

<br>

---

### 2계층 장비: 스위치(switch)

> **_허브의 단점을 보완한 것_**

- 스위치라는 장비를 이용해 스위치에 연결되어 있는 컴퓨터들이 이더넷이라는 규칙하에 프레임을 주고 받는다. 
- 이 방법으로는 **동일한 스위치에 연결되어 있는 컴퓨터들끼리만** 데이터를 주고받을 수 있다. 

    - 스위치에는 여러 포트를 가지고 있는데, 각 포트마다 host가 연결되어 있어서, 각 포트마다 다른 맥 주소를 가진다.  
    - 그래서 데이터를 보낼 때 맥 주소가 있는지 체크하여 존재하면 바로 보낼 수 있고, 없으면 플러딩을 한다.  

🔆 스위치에 연결된 컴퓨터가 연결된 다른 컴퓨터에게 보낼려고하는데 MAC address가 없을 경우에는 switch에 연결된 모든 컴퓨터에게 보낸다. 이를 **_플러딩(Flooding)_** 이라 한다.


- 그러면 스위치 밖에 있는 컴퓨터와는 어떻게 데이터를 주고 받을까?

<br>

---

## 3.3 3계층: 네트워크 계층

> **_굉장히 중요한 계층으로, 3계층 장비인 라우터에 스위치에 연결되어 있어서 각 스위치로 전달한다._**

- **네트워크란? 하나의 스위치에 연결되어 있는 컴퓨터의 모음** 인데, 그러면 서로 다른 네트워크에 있는 컴퓨터들은 어떻게 데이터를 주고 받을까???

- 네트워크 계층에서는 라우터라는 장비를 사용한다. 

- 이 라우터라는 장비는 2계층의 스위치와 1계층의 허브 기능을 모두 포함한다. 요즘은 스위치와 라우터를 혼용해서 언급하기도 한다.  

<br>

### 각 계층에서의 장비, 주소, 비트

|계층 사용 장비 | 주소 | 비트, 진수|
|----|----|----|
|1계층: 허브사용 |||
|2계층: 스위치 사용| MAC 주소를 사용 | 48비트, 16진수|
|3계층: 라우터 사용 | IP 주소를 사용 | 32비트, 10진수|

- 네트워크 계층에서도 header를 붙히는데 IP 헤더라고 부른다.  

- 그리고 3계층에서 헤더와 데이터를 합친 단위를 **_IP packet_** 이라 한다.  
    - IP packet = IP header + data
    - 이 IP header에는 많은 정보들이 담겨있다.  

- IP address = Network ID + Host ID
    - Network ID : 자신이 속한 네트워크  
    - Host ID: 해당 네트워크에 속한 특정 컴퓨터  

<br>

### IP 주소 형식

- IP 수가 부족해서 IPv6를 만들었다.  

| | IPv4 | IPv6 |
| ---- |---- |---- |
| 주소 형식 | 127.0.0.1 | FE80:CD00:0000:0CDE:1257:0000:211E:729C |
| 주소 표현 | 10진수 | 16진수 |
| 크기 | 32비트 | 128비트 |
| 최대 표현 개수 | 4.29 x 10^(9) | 3.4 x 10^(38) | 

<br>

### 공인(public) IP 와 사설(private) IP

- 공인 IP: 인터넷 전체에서 유일한 주소. ex) 대한민국 서울시 강남구 OO동 OO아파트
- 사설 IP: 네트워크 상에서 유일한 주소. ex) 101동 101호  

- 그래서 다른 분께 IP 주소를 언급할 때 공인 IP를 말해야 한다. 사설만으로는 알 수 없다.  

❗️ 공인 IP가 써야되는 곳에 사설 IP 주소를 쓰면 안되므로, 먼저 서버를 구축하기 전에 학습한다.

<br>

### 네트워크 ID class

- IP 주소는 네트워크 ID와 호스트 ID로 구성되었는데, 네트워크의 크기에 따라서 더 분류된다.

- **A class: 대규모 네트워크**
    - 00000001 00000000 00000000 00000000
    - 프리픽스 8자리: 네트워크 ID / 나머지: 호스트 ID


- **B class: 중간 규모 네트워크**
    - 00000001 00000000 00000000 00000000
    - 프리픽스 16자리: 네트워크 ID / 나머지: 호스트 ID
    - docker에서 만드는 컨테이너의 IP 주소를 보면 B class임을 알 수 있다.  


- **C class: 소규모 네트워크**
    - 10000000 00000000 00000000 00000000
    - 프리픽스 24자리: 네트워크 ID / 나머지: 호스트 ID


| 클래스 | A class | B class | C class |
|---- | ----| ---- | ---- |
| 공인 IP 주소 범위 | 1.0.0.0 ~ 9.255.255.255, 11.0.0.0 ~ 126.255.255.255 | 128.0.0.0 ~ 172.15.255.255, 172.32.0.0 ~ 191.255.255.255 | 192.0.0.0 ~ 192.167.255.255, 192.169.0.0 ~ 223.255.255.255 |
| 사설 IP 주소 범위 |10.0.0.0 ~ 10.255.255.255.255 | 172.16.0.0 ~ 172.31.255.255 | 192.168.0.0 ~ 192.168.255.255 |
| 프리 픽스 | 8자리 | 16자리 | 24자리 |

<br>

### 네트워크 주소와 브로드 캐스트 주소

- IP 주소
    - 네트워크 주소: 호스트 ID가 모두 10진수로 0인 주소
    - 브로드캐스트 주소: 호스트 ID가 모두 10진수로 255인 주소 
        - 네트워크에 있는 모든 호스트로 데이터를 전달하는 방식

❗️네트워크 주소와 브로드 캐스트 주소는 IP주소로 할당 불가능  

### 서브넷

> **_A class와 같은 대규모 네트워크를 작은 네트워크로 분할하는 것을 '서브네팅'이라 하고, 분할된 각각의 네트워크를 서브넷이라 한다._**

- 그리고, IP 주소의 관점에서 보자면 호스트 ID의 일부를 서브넷 ID로 사용한다.  

### 서브넷 마스크

> **_네트워크 ID와 호스트 ID를 식별하기 위한 값_**

| 클래스 | 서브넷 마스크 10진수| 서브넷 마스크 2진수 | 프리픽스 |
| ---- | ---- |  ---- | 
| A | 255.0.0.0 |11111111 00000000 00000000 00000000 |/8 |
| B | 255.255.0.0 | 11111111 11111111 00000000 00000000 |/16|
| c | 255.255.255.0 | 11111111 11111111 11111111 00000000 |/24|

🔆 프리픽스 표기법: 서브넷 마스크를 슬래시 비트 수로 나타낸 것으로, 네트워크 ID 부분을 나타낸다.

<br>

### 라우터를 통한 스위치 간 흐름

host가 스위치에 데이터를 보내면 스위치는 라우터와 연결되어 있기 때문에, 같은 스위치 내의 host가 아니면 라우터로 데이터가 전달 -> 라우터는 수신처의 스위치로 데이터를 전달 -> 스위치가 받아서 해당되는 Host에 전달

각 Host의 기본 게이트웨이(default gateway)는 라우터의 연결된 IP 주소다.  


<br>

---

# Reference

- [나노디그리 러닝스푼즈: Python & Django backend course](https://learningspoons.com/course/detail/django-backend/)
- [OSI 7 layer](http://wiki.hash.kr/index.php?title=OSI_7_%EA%B3%84%EC%B8%B5&mobileaction=toggle_view_desktop)